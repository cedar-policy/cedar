/*
Authorization:

 Can User::alice view Photo:VacationPhoto94.jpg
 Decision: Allow
*/

cargo run  authorize \
    --policies tiny_sandboxes/sample1/policy.txt \
    --entities tiny_sandboxes/sample1/entity.json \
    --request-json tiny_sandboxes/sample1/request.json

or, provide the principal, action, and resources separately

cargo run  authorize \
    --policies tiny_sandboxes/sample1/policy.txt \
    --entities tiny_sandboxes/sample1/entity.json \
    --principal 'User::"alice"' \
    --action 'Action::"view"' \
    --resource 'Photo::"VacationPhoto94.jpg"'

/*
Validation:

Is policy.txt valid based on the schema schema.json
*/

cargo run  validate \
    --policies tiny_sandboxes/sample1/policy.txt \
    --schema tiny_sandboxes/sample1/schema.json

/*
Evaluate:
Evaluate a Cedar expression
*/

cargo run  evaluate  \
    --request-json tiny_sandboxes/sample1/request.json \
    --entities tiny_sandboxes/sample1/entity.json \
    "principal in UserGroup::\"jane_friends\""


cargo run  evaluate  \
    --principal 'User::"alice"' \
    --action 'Action::"view"' \
    --resource 'Photo::"VacationPhoto94.jpg"' \
    --entities tiny_sandboxes/sample1/entity.json \
    "principal in UserGroup::\"jane_friends\""


cargo run  evaluate  \
    --request-json tiny_sandboxes/sample1/request.json \
    "[\"a\",true,10].contains(10)"
